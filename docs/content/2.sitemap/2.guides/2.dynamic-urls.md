---
title: Dynamic URL Endpoint
description: Use runtime API endpoints to generate dynamic URLs for your sitemap.
---

In some instances, like using a CMS, you may need to implement an endpoint to make 
all of your site URLs visible to the module.

To do this, you can provide [user sources](/sitemap/getting-started/data-sources) to the module.

## Create your own endpoint

In this guide we'll implement a simple API endpoint that returns a list of URLs.

1. Create a new API endpoint

::code-group

```ts [Simple]
// api/__sitemap__/urls.ts
export default defineSitemapEventHandler(() => {
  return [
    {
      loc: '/about-us',
      // will end up in the pages sitemap
      _sitemap: 'pages',
    }
  ]
})
```

```ts [Multiple Sitemaps]
export default defineEventHandler(async () => {
  const [
    posts,
    pages,
  ] = await Promise.all([
    //
    $fetch('/api/posts')
      .then(posts => posts.map(p => ({
        loc: p.slug,
        // only if you're using manual chunking with app sources
        _sitemap: 'posts'
      }))),
    $fetch('/api/pages'),
  ])
  return [...posts, ...pages, ...products].map((p) => {
    return { loc: p.url, lastmod: p.updatedAt }
  })
})
```

::

2. Add the endpoint to your `nuxt.config.ts`

::code-group

```ts [Single Sitemap Sources]
export default defineNuxtConfig({
  sitemap: {
    sources: [
      '/api/__sitemap__/urls',
    ]
  }
})
```


```ts [Multi Sitemap Sources]
export default defineNuxtConfig({
  sitemap: {
    sitemaps: {
      posts: {
        sources: [
          '/api/__sitemap__/urls/posts',
        ]
      }
    }
  }
})
```

::

## Fetch from an external API

If you need to fetch the URLs from an external API, you can again use the `sources` option.

When fetching from external APIs you may need to provide some fetch options, to do this you can provide a source as an array.

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  sitemap: {
    sources: [
      // hit a remote API with credentials
      [
        'https://api.example.com/pages/urls',
        // fetch options
        { headers: { Authorization: 'Bearer <token>' } }
      ]
    ]
  }
})
```
